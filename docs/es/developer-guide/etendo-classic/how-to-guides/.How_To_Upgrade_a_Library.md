![](skins/openbravo/images/social-blogs-sidebar-banner.png){: .legacy-image-style}

######  Caja de herramientas

![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} Página principal  
![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} Subir archivo  
![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} Qué enlaza aquí  
![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} Cambios recientes  
![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} Ayuda  
  
  

######  Buscar

######  Participar

![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} Comunicarse  
![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} Informar de un error  
![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} Contribuir  
![](skins/openbravo/images/flecha1.jpg){: .legacy-image-style} ¡Hable con nosotros ahora!  

  

#  Cómo actualizar una biblioteca

##  Contenido

  * 1  Visión general 
  * 2  Requisitos previos 
    * 2.1  Compatibilidad de versión de JDK 
    * 2.2  Compatibilidad de licencia 
  * 3  Proceso 
    * 3.1  Comprobar cambios en la API 
      * 3.1.1  Comprobar compatibilidad del código fuente 
      * 3.1.2  Comprobar cómo afectan estos cambios a los módulos publicados 
        * 3.1.2.1  Añadir una nueva biblioteca 
      * 3.1.3  Publicar cambios en la API 
    * 3.2  Actualizar la carpeta ` legal ` 
    * 3.3  Actualizar el archivo .classpath 
    * 3.4  Actualizar la wiki 

  
---  
  
##  Visión general

![](/assets/developer-guide/etendo-classic/how-to-guides/Bulbgraph.png){: .legacy-image-style} |  El público objetivo de este documento es principalmente el personal de Openbravo. Describe el proceso interno que debe seguirse siempre que sea necesario actualizar una biblioteca. Se aplica tanto a las bibliotecas incluidas en la distribución de Openbravo 3 como a las bibliotecas entregadas por módulos.  
---|---  
  
De vez en cuando, es necesario actualizar una biblioteca Java (un archivo jar) a una versión más reciente. Las motivaciones para ello pueden ser diversas:

  * Hacer uso de nuevas capacidades 
  * Eliminar errores de una versión anterior 
  * Mantener la pila actualizada 
  * ... 

Para actualizar una biblioteca, debe seguirse el proceso descrito a continuación.

##  Requisitos previos

![](/assets/developer-guide/etendo-classic/how-to-
guides/How_To_Upgrade_a_Library-1.png){: .legacy-image-style} |  Si no se cumple cualquiera de los siguientes requisitos previos, **no será posible** actualizar la biblioteca a la versión más reciente.  
---|---  
  
Tenga en cuenta que estos requisitos previos también se aplican al añadir una nueva biblioteca.

###  Compatibilidad de versión de JDK

**Todos** los jars deben ser compatibles, al menos, con la versión mínima de JDK soportada por Openbravo. Si el jar se compila con una versión superior, no podrá utilizarse en instancias que ejecuten una versión anterior (sí al revés).

Para comprobar la versión de JDK utilizada para compilar esta biblioteca:

  * Descomprima el nuevo jar: ` unzip _new-library.jar_ -d /tmp/new-library `
  * Normalmente, en el archivo ` META-INF/MANIFEST.MF ` hay información sobre el JDK utilizado para compilarlo 
  * También es posible comprobar el JDK utilizado para compilar archivos ` .class `. Esto se hace con el programa ` javap ` comprobando el valor de la versión principal. Aquí puede encontrar cómo se corresponden con los números utilizados actualmente. El siguiente script lista las versiones de todos los archivos ` .class `; tenga en cuenta que puede tardar si hay muchos archivos en el jar: ` for f in `find -name "*class"`; do javap -verbose $f | grep "major version"; done | sort | uniq `

###  Compatibilidad de licencia

Normalmente, las bibliotecas seleccionan una licencia y la mantienen entre distintas versiones. Pero a veces la licencia cambia de una versión a otra.

Al actualizar una biblioteca (o incluir una nueva), debe comprobar la licencia de la versión más reciente.

  * Si es la misma que la versión anterior, no hay problema. 
  * Si es diferente, compruébelo en el archivo ` legal/Licensing.txt `: 
    * Si la nueva licencia ya se utiliza en cualquiera de las bibliotecas incluidas, no hay problema 
    * Si no, debe consultarse a un abogado si la nueva licencia permite distribuir esta biblioteca 

##  Proceso

Una vez satisfechos los requisitos previos, el proceso de actualización consiste en los siguientes pasos:

###  Comprobar cambios en la API

Una nueva versión de la biblioteca puede cambiar su API pública. Para comprobar estos cambios:

    
    
     hg clone clone https://code.openbravo.com/erp/devel/api-checks/
     cd api-checks/java/tools
     java -classpath japitools.jar net.wuffies.japi.Japize as /tmp/old-api apis _path_to_old_jar_ $JAVA_HOME/jre/lib/rt.jar $JAVA_HOME/jre/lib/jsse.jar +org # change org with the topmost part of the package in the library
     java -classpath japitools.jar net.wuffies.japi.Japize as /tmp/new-api apis _path_to_new_jar_ $JAVA_HOME/jre/lib/rt.jar $JAVA_HOME/jre/lib/jsse.jar +org # change org with the topmost part of the package in the library
     ./japicompat /tmp/old-api.japi.gz /tmp/new-api.japi.gz | tee /tmp/api-checks.txt
    

Estos pasos generarán un archivo ` /tmp/api-checks.txt ` que detalla todos los cambios que puedan existir.

####  Comprobar compatibilidad del código fuente

Incluso cuando las herramientas de api-checks no encuentran ningún cambio en la API, puede haber incompatibilidades de código fuente de la nueva versión con las anteriores; consulte aquí un ejemplo. Para comprobarlo, revise las notas de la versión de la biblioteca desde la versión anterior hasta la nueva.

####  Comprobar cómo afectan estos cambios a los módulos publicados

![](/assets/developer-guide/etendo-classic/how-to-guides/Bulbgraph.png){: .legacy-image-style} |
Este paso solo es aplicable en caso de cambios en la API o al incluir una nueva biblioteca.  
---|---  
  
Obtenga el código de todos los módulos publicados en Central Repository. Si tiene acceso al servidor de Central Repository, siga los siguientes pasos; si no, pida a otra persona (ALO, SHU, AMA...) que lo haga por usted.

    
    
    git clone https://github.com/alostale/ob-scripts.git
    ob-scripts/getAllModules/get-modules.sh
    ob-scripts/getAllModules/unzip-modules.sh
    

Esto generará un directorio ` src ` con los fuentes de todos los módulos publicados.

Ahora puede comprobar en el código cómo se utiliza la biblioteca y si estos cambios pueden afectarlos. Esto le dará una idea del riesgo de estos cambios y podría, eventualmente, requerir abortar el proceso de actualización.

#####  Añadir una nueva biblioteca

Al añadir una nueva biblioteca, compruebe en los módulos publicados si ya existen módulos que la entreguen. Preste especial atención a si incluyen una versión diferente de la que usted quiere actualizar, porque en ese caso podrían aparecer problemas de incompatibilidad al instalar ese módulo junto con su biblioteca. Dependiendo de cuán grande sea el impacto, será necesario tomar una decisión sobre qué hacer (proceder y comunicárselo al propietario, abortar la actualización, etc.).

####  Publicar cambios en la API

En caso de que haya cambios en la API, publíquelos en la wiki siguiendo el proceso definido.

###  Actualizar la carpeta ` legal `

Todos los módulos que contienen bibliotecas de terceros deben tener un directorio ` legal `, que lista las licencias de todas las bibliotecas incluidas. También tiene un archivo ` Licensing.txt `, que lista todas las versiones de bibliotecas y la licencia que tienen.

  * Actualice el archivo ` Licensing.txt ` para reflejar la nueva versión 
  * En caso de una licencia diferente: 
    * Incluya el texto si aún no está presente 
    * Compruebe si la licencia antigua sigue siendo utilizada por cualquier otra biblioteca; si no, elimine el archivo de licencia no utilizado 

###  Actualizar el archivo .classpath

La biblioteca se referencia en el archivo .classpath. Si el nombre del jar ha cambiado, el archivo debe actualizarse con el nuevo nombre.

###  Actualizar la wiki

Al actualizar una biblioteca incluida dentro de la distribución de Openbravo 3, actualice la página de la wiki que lista todas las bibliotecas incluidas.

Recuperado de "  http://wiki.openbravo.com/wiki/How_To_Upgrade_a_Library  "

Se ha accedido a esta página 9,458 veces. Esta página se modificó por última vez el 8 de abril de 2019, a las 14:45. El contenido está disponible bajo la licencia Creative Commons Attribution-ShareAlike 2.5 Spain License  .

  
**

Categoría  :  Cómo hacer

**